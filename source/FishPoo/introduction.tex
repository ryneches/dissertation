\section{Introduction}

In nearly every ecosystem to which it has been applied, culture-independent sequencing has revealed massive diversity of microorganisms. There has been progress in characterizing the biodiversity of many microbial ecosystems by coupling these tools with databases and statistical models. For some ecosystems, such as the human gut, geothermal springs, hypersaline lakes, the cow rumen and some fermented foods, it might be said that the biodiversity is reasonably well characterized. In those systems, ecologists have begun to shift their focus from surveying biodiversity to characterizing interactions, and the question ``Who is there?'' is beginning to give way to ``What are they doing?'' This represents important progress, but bypasses the question, ``Where did they come from?'' This is unfortunate, because continuity through different contexts is often the strongest evidence signifying an organism's ecosystem function.

Dispersal determines whether or not organisms will meet and interact, and if so, how often. It shapes the nature of interactions that do occur. It is the first-order effect behind the establishment of species ranges. The interpenetrating dispersal of many organisms is the process that drives the assembly of ecosystems. However, dispersal has only been thoroughly studied in a handful of organisms, consisting mostly of plants, animals and diseases of plants and animals. Relative to plants and animals, little is known about the dispersal of microorganisms, and as a result, very little is understood about their natural histories. Microscopy, culture-based and molecular genetic methods have revealed a great deal about the physiology of microorganisms, but they have revealed only a patchy, distorted view of microbial natural history.

Consider, for example, what inferences a well-trained naturalist could draw if she noticed a bird within her habitat of expertise. She would likely know whether or not it is unusual to find in that habitat. She would know whether it is migratory or resident. In many cases, she would be able to guess its approximate origin with some confidence. 

Now, suppose she instead discovered a bacterium. First, she must invest a fair amount of time and money to identify the organism. Having done so, she would be somewhat lucky if the closest relative known to science could be said to be within the same genus. Not only would it be difficult for her to know which species she had found, but it would just as difficult to know if she had previously observed the same organism. Given all of this uncertainty, it is in most cases difficult to say if an observation is unusual or surprising. As for where it came from, she would be forced to speculate.

Twenty years ago, it was hoped that metagenomics would be the key to understanding microbial ecosystem function. Unfortunately, there has been relatively little improvement in our ability to predict function from gene sequences. Inferences from comparative genomics about gene function must ultimately be grounded in experimental evidence, and so additional genomes and metagenomes tend to raise more questions than they answer. In retrospect, this is not surprising; for macroscopic systems, it is usually impossible to learn anything about ecosystem function from any composite of extremely small details. An inventory of myoglobin sequences won't reveal whether bears typically eat salmon or salmon typically eat bears. However, knowledge of how the physiology of bears and salmon plays into their ecosystem roles {\em does} reveal interesting insights on myoglobin. There are few genes that are understood at a level of detail sufficient to leverage inference in the other direction.

Although motion through space is conceptually simple, the movement of populations of organisms is a complex a nuanced problem. The first order of business is the choice of coordinate system. The most obvious coordinate system is space; geographic distance often serves as a barrier separating populations. Among plants and animals, it is natural to conceptualize dispersal in geographic terms. A {\em species range}, as it is commonly understood by ecologists, is something that is drawn upon a map. 

\subfile{FishPoo/figure0}

Dispersal tends to structure an organism's biogeography by leaving a positive correlation between genetic distance and geographic distance. Species whose biogeography lacks this structure are said to be ``cosmopolitan''; they move through space quickly relative to their genetic divergence. There has been some recent success in observing microbial biogeography, particularly among extremeophiles. Rachel Whitaker and Thane Papke have developed a strong case for a dispersal-structured biogeography of thermophilic microbes (such as {\em Sulfolobus islandicus} and {\em Oscillatoria amphigranulata}), first by 16S rRNA phylogenetics and later using high resolution, multi-locus methods.

Nevertheless, extremeophiles are perhaps amenable to this approach because their relationship with geographic features is unusual among microbial organisms. Most microbes are found in distributions that have a less obvious relationship to geography. For example, planktonic communities in the ocean are rather undifferentiated along latitude and longitude, but differ sharply along depth and season. In soil, community composition is more strongly influenced by physical properties like pH and humidity than by geography. 

These observations, and others like them, led Lorens Baas Becking to propose what has become the most successful conceptual model for microbial community formation : {\em everything is everywhere, but the environment selects}\footnote{{\em Alles is overal: maar het milieu selecteert.}}. This is a profound idea; it asserts that microbial dispersal is effectively infinite, and that differences of composition among microbial communities is due to selection alone. Taken literally, it means that the only difference between an Erlenmeyer flask and the entire planet is the number of unique niches. It is an assertion that scale is irrelevant.

The Baas Becking model exhorts the researcher to study the context in which microorganisms are observed. Classical microbiology is entirely built on this idea; if we apply macroscopic tools to microscopic organisms, we are perforce working through environmental selection. Most of what we know about microbial physiology, microbial diversity and community structure has been learned by careful manipulation of selection.

Nevertheless, it is important to recognize that the Baas Becking model cannot be literally true, or rather, that is only true to within the limits of the observational methodology. Microbes do not disperse among the continents by quantum teleportation. They must face barriers and obstacles as well as conduits and highways. Even with their rapid growth and vast numbers, this landscape of barriers and conduits must influence their propagation. Moreover, genetic divergence is a necessary and integral aspect of reproduction, and at a minimum, daughter cells cannot occupy the exact same space at the same time. Thus, biogeographic structuring must be present in all populations, but the relative scales of time and distance can vary enormously. Whether or not it can be observed is subject to limitations of methodology and technology.

Of course, Baas Becking was aware of this. In the same 1934 volume in which he proposed his eponymous hypothesis, he observed that there are some habitats that were ideally suited for one microbe or another, and yet these microbes were not present. He offered the following explanation : ``There thus are rare and less rare microbes. Perhaps there are very rare microbes, i.e., microbes whose possibility of dispersion is limited for whatever reason.''

The effects of dispersal can be inferred through the covariance of phylogenetic distance with a measure of distance. When we use geographic distance as our measure of distance, bacteria and archaea usually do not show an obvious relationship with their phylogeny. However, this should not be taken as evidence favoring a literal interpretation of the Bass Becking model.

For any given system, phylogenetic reconstruction will tend to have a practical limit on the minimum scale that can be resolved. Trees are only meaningful if they are based on features that are known to be homologous. Unambiguous identification of homologous features requires that they be conserved, and conserved features usually do not evolve rapidly. Consequently, expedience tends to bias phylogenetics in favor of long time scale variations. Homologous features suitable for phylogenetic inference on short time scales are actually far more abundant in most genomes than highly conserved features, but the ephemeral nature of these features tends to complicate their identification and limit their generality. 

Moreover, while phylogenetic models are intended to vary monotonically with time, there is no guarantee of linearity. It is sometimes possible to improve the linearity of a model by calibrating it to exogenous data, such as fossils records, archival samples or historical accounts, but there are few calibration references available for great majority of microorganisms that do not leave mineralized structures and that are not obligate parasites or symbionts of organisms that leave fossils. Unfortunately, one cannot sidestep this problem by evoking some kind of within-model unit of time. Within a single tree built using the same model of the same set of homologous features, there will exist branches that have evolved at different rates relative to other branches. There are many models that incorporate features to correct for differential rates of evolution, but without calibration references, some uncertainty will always remain.

To detect an unambiguous correlation between geographic distance and phylogenetic distance among lineages, not only must both measures have scales that exceed their uncertainties, but the covariance of the two measures must fall within these scales. Unfortunately, phylogenetic distance tends to have a large minimum scale due to the uncertainties involved, and geographic distance has a ineluctable maximum scale imposed by the size of the planet. Whitaker and Papke demonstrate that the covariance falls within the available scales for some organisms, but this is not generally the case.

At the time of writing, high throughput sequencing technology can target a $\approx$ 256 base pair subregion of the 16S gene, yielding broadly-scoped and economical surveys of bacterial and archaeal diversity. Kuo {\em et al.} estimate $K_{\mathrm{16S}}$ between 0.025\% to 0.091\% per million years. \cite{kuo2009inferring} At this rate of divergence, the targeted fragment of the 16S gene will accumulate one substitution per 4.3 to 15.6 million years. This fact alone goes a long way to explain why dispersal effects have not been widely observed in bacteria and archaea; any dispersal event that runs to equilibrium in less than about ten million years will be invisible to broadly-scoped sequencing strategies.

To date, substantial prior knowledge of the ecology, physiology and genetics has been required for all species of bacteria and archaea for which a dispersal stru biogeogrpahy has been demonstrated. This prior knowledge enables the use of multi-locus sequencing of isolated cultures and the inference of trees with much finer temporal resolution than trees based on a fragment of the 16S gene. However, if we wish to observe dispersal events that are not already anticipated, and if we wish to study dispersal among uncultured organisms, we are for the foreseeable future limited by technology to low temporal resolution.

Given that we're stuck with this long, poorly resolved phylogenetic axis, our only option is to do something about the measure of distance we want to plot it against. For the covariance to fall within the usable dynamic range of phylogenetic methods, we need a measure of distance that is large relative to the phylogenetic divergence we can resolve without ambiguity. This calls for something metaphorically similar to switching to a non-inertial frame of reference in a kinematics problem; there are many systems that are difficult to analyze from a stationary frame of reference but are straightforward in a rotating frame (high altitude ballistic trajectories, for example). In our case, we are looking for habitats that can be related to one another through a metric that varies on a scale compatible with the relatively crude metric of time that can be economically obtained from high throughput sequencing of 16S rRNA.

One choice that meets these criteria is to examine organisms that function as habitats for microorganisms. This is easy enough -- multicellular organisms nearly always cohabitate with microorganisms, and tighter interactions are more the norm than the exception. From among these, we may select groups that have been diverging long enough for usable phylogenetic signal to have accumulated among their microbial denizens. In these systems, current technology may reveal the first glimpses into a complete microbial natural history.

Classifying organisms by how long they have been present in a particular habitat can yield insights regarding their origins, especially when these relationships are repeated in many similar but distinct habitats. Phylogeographic models regard this collection of habitats as the nodes of a meta-community network. The edges of this network represent dispersal rates, a convolution of both the vectors of dispersal and the barriers that impinge on those vectors. Organisms move from habitat to habitat in discrete events with probabilities related to the dispersal rates. If organisms are gathered from each habitat, and trees of related organisms are constructed, these trees may be used to infer the rates of dispersal. These rates reveal, at least in broad strokes, the structure of the relationships among the habitats.

The Illumina sequencing platform is has a substitution error frequency of about 0.1\%. \cite{ross2013characterizing} Trimming and filtering reads based on quality score removes about 69\% of substitution errors, on average, \cite{schirmer2016illumina} and overlap correcting paired-end reads improves this to about one substitution error in every 14 reads. \cite{bolger2014trimmomatic} At the sacrifice of sensitivity, the error frequency can be reduced arbitrarily by excluding very rare sequences. For example, excluding sequences observed only once reduces the substitution error frequency to about one in every 200 sequences. Most substitution errors are likely to be corruptions of sequences already present in the data, and so phylogenetic reconstruction should place them as sister leafs of their uncorrupted sources. This confines the effect of substitution errors to the smallest topological scale, where it appears in the form of ``extra'' leafs that are randomly attached with the minimum branch length.

In this study, we attempt to use current technology to answer this and some related questions. As technology allows researchers to gather more phylogenetically informative data, the power of the approach described here will improve. 

The assemblage of habitats we have chosen for this study are the Tanganyikan cichlid fish. With the exception of {\em Tylochromis polylepis} and {\em Oreochromis tanganicae}, the Tanganyikan cichlids are a species flock of more than two hundred described species sharing a common ancestor dating to the formation of the lake between nine and twelve million years ago. While some members of this species flock are older than hominids, other lineages have undergone much more recent speciation, including some in which the process of adaptive radiation appears to be ongoing. Within this species flock, a large variety of reproductive, defense and trophic strategies have evolved. Other than the anoxic abyssal region, cichlids have colonized every habitat in the lake and occupy every trophic level above primary producers. Taken together, this species flock represents roughly 1\% of all described fish species and 0.5\% of all vertebrate species.