\section{Discussion}

Some form of co-diversification is probably inevitable in situations where multiple species remain in ecological contact over evolutionary time. Most of the literature on the topic addresses the co-diversification in one of two ways, depending on the initial assumptions :

\begin{enumerate}
	\item {\em Given a system in which co-diversification may have occurred, what is the likelihood that it did?}

	\item {\em Given that co-diversification is known to have occurred, what is the most likely history?}
\end{enumerate}

We are interested in learning about the natural history of the system, and so we would like to ask a somewhat enlarged question. {\em Given a system in which there are many opportunities where co-diversification may have occurred, which cases are the most likely?} 

\subsection{Phylogenetic signal and trait-based approaches}

For each organism that appears among the microbioms of a group of hosts, there exists a pattern of observed associations between the ``guest'' organism and the host organisms. These associations can be treated as traits of the host, and the history of each association can be examined like any phenotypic trait. Alternatively, the tendency to associate (or not) with a host could be treated as a trait distributed over a group of microbial organisms, although it is difficult to imagine how one might demarcate the boundaries between groups. Association with a particular host is more likely to correspond to different traits for more distantly related bacteria, and so it is probably not meaningful to naively apply stochastic trait mapping across all bacterial diversity.

In {\em Analysis of phylogenetics and evolution with {\tt R}} (p. 236), Emmanuael Paradis describes phylogenetic signal as follows :

\begin{quote}
The concept of phylogenetic signal is at the heart of most phylogenetic methods. From a statistical point of view, a phylogenetic signal is defined by the non-null covariances (i.e., non-independence) among species. From a biological point of view, phylogenetic signal is a direct consequence of the evolution of traits and its form will depend on the evolutionary mechanisms in action.
\end{quote}

The advantage of this approach is that it decomposes the problem into a large number of smaller problems. Every OTU is treated as an independent trait, and observed associations are simply plugged into one of the four established models. All of them have been implemented in {\tt R}. Unfortunately, this is also a key disadvantage. Most trait-based models do not account for interactions {\em among} traits, or a way to account for traits that have their own evolutionary model, independent of the organisms that exhibit them. 

A second disadvantage of trait-based approaches when applied to co-diversifying systems arises from the non-uniform distribution of microbial diversity with respect to 16S diversity. Individual OTUs may represent several organisms, each with their own pattern of association (Figure \ref{fig:FP_fig4}). Comparing phylogenetic signal among different OTUs thus depends on the diversity underlying each of the OTUs. Correcting for this would require a relatively complete and unbiased survey of microbial diversity.

\subfile{FishPoo/figure4}

\subsection{Tests for cospeciation}

In what could now be considered a classic paper, Hafner {\em et al.} \cite{hafner1994disparate} examine the relationship between pocket gophers and their chewing louse parasites. This paper addresses there first question using a tree reconciliation test implemented in {\tt COMPONENT} by Roderic D. M. Page \cite{page1993genes}. It is, in essence, a parsimony approach; the gene duplication and loss events necessary to achieve topological congruence between two trees are minimized. Hafner {\em et al.} first reject the null hypothesis (independent evolution) by applying the tree reconciliation test among gopher, louse and randomly drawn trees, and then examine rates of nucleotide divergence between the gopher and louse. 

This dataset has since been reanalyzed in many other publications, has become a sort of base-case for co-diversification methods. Notably, Huelsenbeck {\em et al.} introduced the use of Bayesian inference to cospeciation \cite{huelsenbeck2000bayesian}.

Hommola {\em et al.} \cite{hommola2009permutation} describe a method extends the Mantel test. \cite{mantel1967detection} The Mantel test is a statistic on the correlation of two matrixes, and requires that the matrixes be of equal rank. When applied to distance matrixes for trees containing differing numbers of taxa, one must delete or duplicate taxa until the matrix ranks are equal. This results in anomalous results which Hommola {\em et al.} explore in detail. To address this issue, they take every pair of linked tips (e.g., a parasite species that is observed to associate with a host species), and examine the correlation of distances through the two trees. This accommodates trees of arbitrary size and arbitrary patterns of association among their tips, and can be coupled with a straightforward permutation test to estimate the significance of the correlations. One can walk through every clade in the phylogeny of host-associated OTUs and, every clade, compute the Hommola correlation with the host phylogeny (Figure \ref{FP_hommola_corr}). 

\subfile{FishPoo/figure5}

However, there are some important difficulties when it comes to applying the Hommola cospeciation test to a large number of clades belonging to the same tree. Fist of all, this approach necessarily entails multiple comparison, and so a correction to the significance values is required. However, a Bonferroni correction is not appropriate because the structure of each clade is not independent of the others. Rather, they are hierarchically nested within a tree, which is itself inferred from an probabilistic model (an approximate maximum likelihood model, in this case), which is based on nucelotide transitions inferred from from an alignment. The autocorrelation within the tree would need to be accounted for, but calculating it would not be straightforward. At a minimum, one would need to take into account the fact that the multiple comparisons have hierarchical relationships.

The second difficulty arises from the need to perform unsupervised correlation tests. Hommola {\em et al.} use the Pearson product-moment correlation, which assumes that the processes are independent, identically distributed, and follow a bivariate normal distribution. Unfortunately, there is reason to suppose that the distances among tips of a phylogenetic tree would be normally distributed. Of course, other correlation statistics could be substituted at the expense of computational complexity (Spearman's rank correlation coefficient, for example, obeys quadratic scaling), but the number OTUs present in a typical microbiome would call for the use of a supercomputer.

\subfile{FishPoo/figure6}

The reliance on a summary statistic likely dooms the application of Hommola {\em et al} as a way to detect co-diversification in the microbiome, where a supervised method is not practical. All summary statistics are a form of information reduction, usually a projection into a 1-dimensional space, and their interpretation depends on structural properties within the data. While it is often possible to construct complimentary tests to insure that assumptions hold, those tests are themselves likely to rely on summary statistics. Ultimately, someone has to actually inspect the data. \cite{anscombe1973graphs} For example, compare the distribution of pairwise distances for the Gopher/Louse dataset \cite{hafner1994disparate} to Clade 72223, which appears just below it in Figure \ref{FP_highcorr}. Both have about the same correlation coefficient ($r=0.490$ verses $r=0.488$), very high significance ($1.38\times 10^{-9}$ verses $p=3.21\times 10^{-223}$ and are within an order of magnitude in size ($15 \times 17$ verses $14 \times 68$). Nevertheless, the two distributions are obviously different, and the vertical banding pattern in Clade 72223 is strongly reminiscent of Case 4 in Anscombe's quartet. The structural differences between these interactions can also be seen clearly when represented as tanglegrams (Figure \ref{fig:FP_tangles}).

\subfile{FishPoo/figure7}

In principle, one could develop a hierarchical Bonferroni correction, design correlation tests that exclude artifactual features that crop up in distributions of patristic distances, and run obtain the use of a powerful supercomputer. However, a third difficulty remains. All of the approaches mentioned so far are based upon an idealized model of co-diversification. In the ideal case, the host and the guest organisms would diverge in lockstep and exhibit phylogenies of perfectly congruent structure. One might imagine this to be the case for vertically transmitted symbionts, but the reality is that it is not even true for different genes within the same organism. Indeed, many of the methods used to study co-diversification were originally developed with the aim of reconciling gene trees into species trees. Real cases of co-diversification can be expected to manifest along with other effects, such as ecological interactions with organisms that do not belong to either clade, stochastic variations in nucleotide divergence, extinctions, sampling bias and the emergence of cryptic species. The model, and the statistical tests applied to it, must be able to distinguish between a real case with deviations arising from these other processes and a spurious or artifactual resemblance to one. If the effect of competing processes were small, one could apply the a stringent statistical cutoff. Unfortunately, this is not the case. As mentioned before, the Gopher/Louse dataset from Hafner {\em et. al.} exhibits a Hommola correlation of $r=0.49$, which is rather poor as correlated processes go. Nevertheless, the ecological case for cospeciation is solid and its physiological basis is sound. The Sedge/Smut interaction from Escudero \cite{escudero2015phylogenetic} is also well established, but has a Hommola correlation of only $r=0.15$. It would not make sense to search for new cases of co-diversification with a method that only works within a statistical stringency that would exclude all known cases of the effect. It is possible to address this problem by including other processes in the model, but each new parameter also introduces additional risk of overfitting.

\subsection{A comparative approach}

All model-based methods must convincingly demonstrate that they provide the appropriate selectivity, sensitivity and parameter selection for their application. This is more challenging for some applications than others, and the detection of co-diversificaiton among hosts and their associated organisms of their microbiomes using markers with low temporal resolution appears to be rather unkind to model-based methods. Comparative methods sidestep many statistical vulnerabilities of model-based methods, exchanging them instead for the epistemological vulnerabilities of database bias. Fortunately, the number of multi-species interactions is combinatorial with the number of species (though constrained by propinquity), and the ecological literature is rich with examples. A database drawn from the existing literature would suffer from bias, but it would not be small.

Rather than comparing candidate cases to a model, a comparative approach calls for a metric that scales with dissimilarity among cases. Measures of dissimilarity are not summary statistics, and it is possible to construct them with fewer assumptions. 

\subfile{FishPoo/figure8}

Here, we propose an comparative method for co-diversifying systems that extends an approach developed by Lewitus and Morlon \cite{lewitus2015characterizing} for use with phylogenetic trees. The graph adjacency matrixes for each phylogenetic tree are constructed, as per Lewitus and Morlon. The total phylogenetic distance for each tree is then normalized to unity. Then, the adjacency matrixes for the two trees are joined along a common diagonal, creating two empty rectangular blocks symmetric about the diagonal. These rectangular blocks are where the any between the two joined graphs must exist, and so the interactions between the leaf nodes in the phylogeny are placed here, weighted at the mean branch length of the two trees. The graph Laplacian is constructed (Figure \ref{fig:FP_ajlp}), the eigenvalues are computed and a spectral density distribution (Figure \ref{fig:FP_eigendensity}) is computed, as in Lewitus and Morlon. 

\subfile{FishPoo/figure9}

These spectral density distributions represent 

The dissimilarity between two distribution can be measured using the Kullback-Leibler divergence, $D_{\rm KL}$. 

\begin{equation}
    D_{\rm KL}( p, q ) = \int_{-\infty}^\infty p(x) \, \log\frac{p(x)}{q(x)} \, {\rm d}x
\end{equation}

\noindent The Kullback-Leibler divergence measures the information lost when using distribution $q(x)$ to approximate distribution $p(x)$. This is almost what we want, but unfortunately $D_{\rm KL}$, like subtraction and division, is not metric (in general, $D_{\rm KL}(p,q) \neq D_{\rm KL}(q,p)$ unless $p=q$, in which case $D_{\rm KL}=0$). The information radius, or Jensen-Shannon divergence between the two distributions is metric.

\begin{equation}
    D_{\rm JD}( p, q ) = \sqrt{ \frac{1}{2} D_{\rm KL}( p, q ) + \frac{1}{2} D_{\rm KL}( q, p ) }
\end{equation}

\noindent To demonstrate how this metric performs, we compare permutations of the Gopher/Louse dataset from Hafner {\em et al.}. Keeping the tree structures intact, a collection of spectra were computed by randomly reassigning links between leaf nodes (Figure \ref{fig:FP_ajperm}) and computing the Jensen-Shannon divergence between successively more permuted spectral distributions and the spectral distribution of the original, un-permuted graph (Figure \ref{fig:FP_permuted_distances}). The metric is neither linear nor monotonic, but it does diverge predictably. 

\subfile{FishPoo/figure10}

\subfile{FishPoo/figure11}